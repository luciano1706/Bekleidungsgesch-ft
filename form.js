!function(){function User(){this.ui={},this.ui.elements=["session","passwordRecovery","signUp"],this.ui.session={formContainer:".js-session-form-container",form:".js-session-new-form",error:".js-session-error",modal:"#sign-in-modal",notification:"devise.sessions.signed_in"},this.ui.passwordRecovery={formContainer:".js-password-recovery-form-container",form:".js-password-recovery-form",error:".js-password-recovery-error",modal:"#password-recovery-modal",notification:"devise.passwords.send_instructions"},this.ui.signUp={formContainer:".js-sign-up-form-container",form:".js-sign-up-form",error:".js-sign-up-recovery-error",modal:"#sign-up-modal",notification:"devise.registrations.signed_up"}}User.prototype.init=function(){var user=this;$.each(user.ui.elements,function(index,value){var obj=user.ui[value];user.handleAjaxSuccess(obj),user.handleAjaxErrorOnForms(obj)}),user.showModalIfRequested()},User.prototype.showModalIfRequested=function(){LOGIN_REQUEST&&$(user.ui.session.modal).modal("show"),SIGN_UP_REQUEST&&$(user.ui.signUp.modal).modal("show")},User.prototype.handleAjaxErrorOnForms=function(obj){var user=this,form=obj.form;$(document).on("ajax:error",form,function(event,data,status,xhr){form!=user.ui.signUp.form?user.addErrorsToForm(form,obj.formContainer,data.responseText,obj.error):(user.replaceForm(form,data.responseJSON.form),setTimeout(function(){$(".js-login-input").focus(function(){$(this).parent().parent().children("label").addClass("active")}),$(".js-login-input").parent().parent().children("label").addClass("active"),$(".js-login-input").blur(function(){""==$(this).val()&&$(this).parent().parent().children("label").removeClass("active")}),$(".js-login-input").bind("change paste keyup",function(){""!=$(this).val()?($(this).parent().removeClass("field_with_errors"),$(this).next().css("display","none")):($(this).parent().addClass("field_with_errors"),$(this).next().css("display","block"))})},500))})},User.prototype.handleAjaxSuccess=function(obj){var redirectUrl,success_log,form=obj.form;$(document).on("ajax:success",form,function(event,data,status,xhr){$(obj.modal).modal("hide"),console.log(data),redirectUrl=data.redirect_url,success_log=data.success,redirectUrl?window.location.href=redirectUrl:(console.log(success_log),$.notify({message:I18n.t(obj.notification)},{type:"success"}))})},User.prototype.addErrorsToForm=function(form,formContainer,error,errorPlace){var span,user=this;$(form).fadeOut("normal",function(){user.clearFormInputs(form),span=$("<span />").attr("class","error").html(error),$(errorPlace).replaceWith(span),$(this).fadeIn()})},User.prototype.clearFormInputs=function(form){$.each($(form).find("input[type!='hidden'][type!='submit']:not(.btn):not(.email)"),function(index,input){$(input).val("")})},User.prototype.replaceForm=function(form,newForm){$(form).fadeOut("normal",function(){$(this).replaceWith($(newForm)),$(this).fadeIn()})},window.User=User}(),$(document).ready(function(){var user=new User;user.init()});